{{!-- Weekly Activity Digest Email Template --}}
{{#> base subject="Your Weekly Dating Update - " + stats.totalViews + " People Checked You Out!"}}

<h1>Your Week in Review &#128200;</h1>

<p>Hey {{user.firstName}}, here's what happened on {{siteName}} this week. You've been getting noticed!</p>

<!-- Stats Overview -->
<div class="card card-highlight" style="padding: 32px; margin: 24px 0;">
    <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
        <tr>
            <td width="33%" class="text-center" style="padding: 12px;">
                <div style="font-size: 36px; color: #e91e63; font-weight: 700; line-height: 1;">{{stats.profileViews}}</div>
                <div class="text-muted" style="font-size: 14px; margin-top: 8px;">Profile Views</div>
                {{#if stats.profileViewsChange}}
                <div style="font-size: 12px; color: {{#if stats.profileViewsUp}}#4caf50{{else}}#f44336{{/if}}; margin-top: 4px;">
                    {{#if stats.profileViewsUp}}&#9650;{{else}}&#9660;{{/if}} {{stats.profileViewsChange}}% from last week
                </div>
                {{/if}}
            </td>
            <td width="33%" class="text-center" style="padding: 12px; border-left: 1px solid rgba(233, 30, 99, 0.3); border-right: 1px solid rgba(233, 30, 99, 0.3);">
                <div style="font-size: 36px; color: #e91e63; font-weight: 700; line-height: 1;">{{stats.newLikes}}</div>
                <div class="text-muted" style="font-size: 14px; margin-top: 8px;">New Likes</div>
                {{#if stats.newLikesChange}}
                <div style="font-size: 12px; color: {{#if stats.newLikesUp}}#4caf50{{else}}#f44336{{/if}}; margin-top: 4px;">
                    {{#if stats.newLikesUp}}&#9650;{{else}}&#9660;{{/if}} {{stats.newLikesChange}}% from last week
                </div>
                {{/if}}
            </td>
            <td width="33%" class="text-center" style="padding: 12px;">
                <div style="font-size: 36px; color: #e91e63; font-weight: 700; line-height: 1;">{{stats.newMatches}}</div>
                <div class="text-muted" style="font-size: 14px; margin-top: 8px;">New Matches</div>
                {{#if stats.newMatchesChange}}
                <div style="font-size: 12px; color: {{#if stats.newMatchesUp}}#4caf50{{else}}#f44336{{/if}}; margin-top: 4px;">
                    {{#if stats.newMatchesUp}}&#9650;{{else}}&#9660;{{/if}} {{stats.newMatchesChange}}% from last week
                </div>
                {{/if}}
            </td>
        </tr>
    </table>
</div>

{{#if pendingLikes}}
<!-- Pending Likes Section -->
<div style="margin: 32px 0;">
    <h2>People Who Liked You &#128525;</h2>
    <p class="text-muted">{{pendingLikes.count}} people are waiting to hear from you!</p>

    <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
        <tr>
            {{#each pendingLikes.preview}}
            <td width="25%" class="text-center" style="padding: 8px;">
                <div style="width: 70px; height: 70px; margin: 0 auto; border-radius: 50%; overflow: hidden; background: linear-gradient(135deg, #e91e63 0%, #ff5722 100%); {{#unless ../../user.isPremium}}filter: blur(6px);{{/unless}}">
                    {{#if photoUrl}}
                    <img src="{{photoUrl}}" alt="Profile" style="width: 100%; height: 100%; object-fit: cover;" />
                    {{else}}
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #e91e63 0%, #ff5722 100%);"></div>
                    {{/if}}
                </div>
                <p style="margin: 8px 0 0; font-size: 13px; color: #51545e;">{{#if ../../user.isPremium}}{{firstName}}{{else}}???{{/if}}</p>
            </td>
            {{/each}}
        </tr>
    </table>

    {{#unless user.isPremium}}
    <div class="text-center" style="margin-top: 16px;">
        <a href="{{siteUrl}}/premium" class="btn-secondary">Upgrade to See Who Likes You</a>
    </div>
    {{else}}
    <div class="text-center" style="margin-top: 16px;">
        <a href="{{siteUrl}}/likes" class="btn-primary">View All Likes</a>
    </div>
    {{/unless}}
</div>

<div class="divider"></div>
{{/if}}

{{#if suggestedMatches}}
<!-- Suggested Matches Section -->
<div style="margin: 32px 0;">
    <h2>Suggested Matches for You &#127775;</h2>
    <p class="text-muted">Based on your preferences and activity</p>

    {{#each suggestedMatches}}
    <div class="card" style="margin: 16px 0; padding: 20px;">
        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
            <tr>
                <td width="80" valign="top">
                    <div style="width: 72px; height: 72px; border-radius: 12px; overflow: hidden; background: linear-gradient(135deg, #e91e63 0%, #ff5722 100%);">
                        {{#if photoUrl}}
                        <img src="{{photoUrl}}" alt="{{firstName}}" style="width: 100%; height: 100%; object-fit: cover;" />
                        {{else}}
                        <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: #fff; font-size: 28px; font-weight: 600;">
                            {{firstInitial}}
                        </div>
                        {{/if}}
                    </div>
                </td>
                <td valign="top" style="padding-left: 16px;">
                    <strong style="color: #1a1a2e; font-size: 16px;">{{firstName}}, {{age}}</strong>
                    <p style="margin: 4px 0; color: #9a9ea6; font-size: 13px;">{{location}} &bull; {{compatibilityScore}}% Match</p>
                    <p style="margin: 8px 0 0; color: #51545e; font-size: 14px;">{{bio}}</p>
                </td>
                <td width="100" valign="middle" class="text-center hide-mobile">
                    <a href="{{../siteUrl}}/profile/{{id}}" style="display: inline-block; background: linear-gradient(135deg, #e91e63 0%, #ff5722 100%); color: #fff; padding: 10px 20px; border-radius: 25px; font-size: 14px; font-weight: 600; text-decoration: none;">View</a>
                </td>
            </tr>
        </table>
    </div>
    {{/each}}

    <div class="text-center" style="margin-top: 20px;">
        <a href="{{siteUrl}}/discover" class="btn-primary">Discover More Matches</a>
    </div>
</div>

<div class="divider"></div>
{{/if}}

<!-- Tips Section -->
<div style="margin: 32px 0;">
    <h2>Weekly Dating Tips &#128161;</h2>

    <div class="card" style="background: linear-gradient(135deg, rgba(233, 30, 99, 0.05) 0%, rgba(255, 87, 34, 0.05) 100%);">
        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
            <tr>
                <td width="48" valign="top">
                    <div style="width: 40px; height: 40px; background-color: #e91e63; border-radius: 50%; text-align: center; line-height: 40px; color: #fff; font-size: 20px;">
                        &#128218;
                    </div>
                </td>
                <td valign="top" style="padding-left: 16px;">
                    <strong style="color: #1a1a2e;">{{weeklyTip.title}}</strong>
                    <p style="margin: 8px 0 0; color: #51545e; font-size: 14px; line-height: 1.5;">
                        {{weeklyTip.content}}
                    </p>
                    {{#if weeklyTip.linkUrl}}
                    <p style="margin: 12px 0 0;">
                        <a href="{{weeklyTip.linkUrl}}" style="color: #e91e63; font-size: 14px;">{{weeklyTip.linkText}} &rarr;</a>
                    </p>
                    {{/if}}
                </td>
            </tr>
        </table>
    </div>
</div>

<!-- Profile Strength Reminder -->
{{#if profileStrength}}
{{#unless profileStrength.isComplete}}
<div class="card" style="border: 2px dashed #e91e63; background-color: #fff;">
    <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
        <tr>
            <td>
                <strong style="color: #1a1a2e;">Boost Your Profile Strength</strong>
                <p style="margin: 8px 0; color: #51545e; font-size: 14px;">
                    Your profile is {{profileStrength.percentage}}% complete. Complete profiles get up to 5x more matches!
                </p>
                <div style="background-color: #eaeaec; border-radius: 10px; height: 8px; margin: 12px 0; overflow: hidden;">
                    <div style="background: linear-gradient(135deg, #e91e63 0%, #ff5722 100%); height: 100%; width: {{profileStrength.percentage}}%; border-radius: 10px;"></div>
                </div>
                <p style="margin: 12px 0 0;">
                    <a href="{{siteUrl}}/profile/edit" style="color: #e91e63; font-weight: 600;">Complete your profile &rarr;</a>
                </p>
            </td>
        </tr>
    </table>
</div>
{{/unless}}
{{/if}}

<p class="text-muted text-small text-center" style="margin-top: 32px;">
    See you next week! Keep swiping and stay positive. &#10084;
</p>

{{/base}}
